<html>

<head>
    <title>CurrencyExchange</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <style>
        body {
            background-color: #002c42;
            width: 100%;
            height: 100%;
        }

        .center {
            margin: auto;
            width: 350px;
            padding: 5px;
        }

        html,
        body {
            margin: 0;
            height: 100%;
            overflow: hidden
        }
    </style>
</head>

<body>
    <div class="h-100 row align-items-center">
        <div class="col">
            <div style="text-align: center;"><img src="/static/icon.jpg" style="width: 150px; height:auto;" /></div>
            <div style=" text-align: center;" class="col align-items-center">

                <div class="input-group input-group  center">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-lg">From Rate:</span>
                    </div>
                    <select id="fromrate" class="form-control " name="fromrate" disabled="disabled">

                    </select>
                </div>

                <div class="input-group input-group center">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-lg">To Rate:
                            &nbsp;&nbsp;&nbsp;&nbsp;</span>
                    </div>
                    <select id="torate" class="form-control " name="torate">

                    </select>
                </div>

                <div class="input-group mb-3 center" style="width: 250px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon1">Value:
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                    </div>
                    <input type="number" class="form-control" placeholder="0.00" name="amount" id='amount' required>
                </div>
                <button type="button" onclick="calc()" value="calc" class="btn btn-lg  btn-info">Calculate</button>
            </div>
            <div id="total" style="font-weight: 700; font-family:Arial, Helvetica, sans-serif; text-align: center; font-size: 2rem; color: white;">

                </div>
        </div>
    </div>

</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $.ajax({
        url: 'http://{{ backendip | safe }}:5000/',
        type: 'GET',
        dataType: 'json',
        success: function (res) {
            //rates
            var fr = document.getElementById('fromrate');
            var tr = document.getElementById('torate');

            res.forEach(element => {
                var option = document.createElement("option");
                option.text = element;
                fr.add(option);

                option = document.createElement("option");
                option.text = element;
                tr.add(option);
            });
            fr.value = 'EUR';
        }
    });

    function calc() {
        var fr = document.getElementById('fromrate').value;
        var tr = document.getElementById('torate').value;
        var amount = document.getElementById('amount').value;
        console.log(fr);
        console.log(tr);
        console.log(amount);
        $.ajax({
            url: 'http://{{ backendip | safe }}:5000/calc',
            type: 'POST',
            data: { "fromrate": fr, "torate": tr, "amount": amount },
            dataType: 'json',
            success: function (res) {
                res = JSON.parse(res);
                document.getElementById('total').innerHTML = res["total"];
            }
        });
    }
</script>

</html>